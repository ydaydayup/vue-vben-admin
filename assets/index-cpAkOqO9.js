var he=Object.defineProperty,ye=Object.defineProperties;var ve=Object.getOwnPropertyDescriptors;var te=Object.getOwnPropertySymbols;var be=Object.prototype.hasOwnProperty,Me=Object.prototype.propertyIsEnumerable;var oe=(n,a,s)=>a in n?he(n,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[a]=s,C=(n,a)=>{for(var s in a||(a={}))be.call(a,s)&&oe(n,s,a[s]);if(te)for(var s of te(a))Me.call(a,s)&&oe(n,s,a[s]);return n},j=(n,a)=>ye(n,ve(a));var A=(n,a,s)=>new Promise((c,t)=>{var u=i=>{try{r(s.next(i))}catch(d){t(d)}},e=i=>{try{r(s.throw(i))}catch(d){t(d)}},r=i=>i.done?c(i.value):Promise.resolve(i.value).then(u,e);r((s=s.apply(n,a)).next())});import{h as ie,D as He,q as Ce,X as Se,L as ke,v as Fe,Y as Be,Z as Oe,f as ce,V as we,d as Te,s as Pe,K as ue,t as $e,w as Ne}from"./entry/index-ik9kLCN0-1706159834690.js";import{h as X,u as o,d as R,H as De,k as S,i as Re,f as h,c as k,w as de,o as _e,b as pe,x as P,n as We,_ as M,a9 as N,aa as y,m as xe,$ as V,O as $,ag as Ee,F as je,ac as U,a2 as Le,a8 as Ie,E as Z,a1 as G,ad as L,K as Ae,g as Q,y as qe,ae as ne,ab as ae,aj as le,ak as se,r as fe,I as q}from"./vue-lybwVHEG.js";import{M as ze,aC as Ve,T as K,aD as Xe,aE as Ye,o as z,e as ge,a as Ke}from"./antd-veAxK-b_.js";import{u as Ue}from"./useWindowSizeFn-YZ4hdm43.js";const{t:re}=ie(),Ze={open:{type:Boolean},scrollTop:{type:Boolean,default:!0},height:{type:Number},minHeight:{type:Number},draggable:{type:Boolean,default:!0},centered:{type:Boolean},cancelText:{type:String,default:re("common.cancelText")},okText:{type:String,default:re("common.okText")},closeFunc:Function},ee=Object.assign({},Ze,{defaultFullscreen:{type:Boolean},canFullscreen:{type:Boolean,default:!0},wrapperFooterOffset:{type:Number,default:0},helpMessage:[String,Array],useWrapper:{type:Boolean,default:!0},loading:{type:Boolean},loadingTip:{type:String},showCancelBtn:{type:Boolean,default:!0},showOkBtn:{type:Boolean,default:!0},wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:{type:Boolean,default:!0},closeIcon:Object,confirmLoading:{type:Boolean},destroyOnClose:{type:Boolean},footer:Object,getContainer:Function,mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},maskStyle:Object,okType:{type:String,default:"primary"},okButtonProps:Object,cancelButtonProps:Object,title:{type:String},open:{type:Boolean},width:[String,Number],wrapClassName:{type:String},zIndex:{type:Number}});function Ge(n){const a=(t,u)=>getComputedStyle(t)[u],s=t=>{if(!t)return;t.setAttribute("data-drag",o(n.draggable));const u=t.querySelector(".ant-modal-header"),e=t.querySelector(".ant-modal");!u||!e||!o(n.draggable)||(u.style.cursor="move",u.onmousedown=r=>{if(!r)return;const i=r.clientX,d=r.clientY,H=document.body.clientWidth,f=document.documentElement.clientHeight,p=e.offsetWidth,g=e.offsetHeight,m=e.offsetLeft,v=H-e.offsetLeft-p,F=e.offsetTop,B=f-e.offsetTop-g,b=a(e,"left"),_=a(e,"top");let W=+b,x=+_;b.includes("%")?(W=+document.body.clientWidth*(+b.replace(/%/g,"")/100),x=+document.body.clientHeight*(+_.replace(/%/g,"")/100)):(W=+b.replace(/px/g,""),x=+_.replace(/px/g,"")),document.onmousemove=function(I){let T=I.clientX-i,O=I.clientY-d;-T>m?T=-m:T>v&&(T=v),-O>F?O=-F:O>B&&(O=B),e.style.cssText+=`;left:${T+W}px;top:${O+x}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})},c=()=>{const t=document.querySelectorAll(".ant-modal-wrap");for(const u of Array.from(t)){if(!u)continue;const e=a(u,"display"),r=u.getAttribute("data-drag");e!=="none"&&(r===null||o(n.destroyOnClose))&&s(u)}};X(()=>{!o(n.open)||!o(n.draggable)||He(()=>{c()},30)})}function Je(n){return typeof n=="function"||Object.prototype.toString.call(n)==="[object Object]"&&!Re(n)}const Qe=R({name:"Modal",inheritAttrs:!1,props:ee,emits:["cancel"],setup(n,{slots:a,emit:s}){const{open:c,draggable:t,destroyOnClose:u}=De(n),e=Ce();Ge({open:c,destroyOnClose:u,draggable:t});const r=i=>{s("cancel",i)};return()=>{let i;const d=j(C(C({},o(e)),n),{onCancel:r});return S(ze,d,Je(i=Se(a))?i:{default:()=>[i]})}}}),me=Symbol();function et(n){return Fe(n,me)}function ft(){return ke(me)}const tt=["loading-tip"],ot=R({name:"ModalWrapper",inheritAttrs:!1,__name:"ModalWrapper",props:{loading:{type:Boolean},useWrapper:{type:Boolean,default:!0},modalHeaderHeight:{type:Number,default:57},modalFooterHeight:{type:Number,default:74},minHeight:{type:Number,default:200},height:{type:Number},footerOffset:{type:Number,default:0},open:{type:Boolean},fullScreen:{type:Boolean},loadingTip:{type:String}},emits:["height-change","ext-height"],setup(n,{expose:a,emit:s}){const c=n,t=h(null),u=h(null),e=h(0),r=h(0),i=h(0);Ue(f.bind(null)),Be(u,()=>{f()},{attributes:!0,subtree:!0}),et({redoModalHeight:f});const d=k(()=>({minHeight:`${c.minHeight}px`,[c.fullScreen?"height":"maxHeight"]:`${o(e)}px`}));X(()=>{c.useWrapper&&f()}),de(()=>c.fullScreen,p=>{f(),p?r.value=e.value:e.value=r.value}),_e(()=>{const{modalHeaderHeight:p,modalFooterHeight:g}=c;s("ext-height",p+g)}),pe(()=>{});function H(){return A(this,null,function*(){P(()=>{var g;const p=o(t);p&&((g=p==null?void 0:p.scrollTo)==null||g.call(p,0))})})}function f(){return A(this,null,function*(){if(!c.open)return;const p=o(t);if(!p)return;const g=p.$el.parentElement;if(g){g.style.padding="0",yield P();try{const m=g.parentElement&&g.parentElement.parentElement;if(!m)return;const v=getComputedStyle(m).top,F=Number.parseInt(v);let B=window.innerHeight-F*2+(c.footerOffset||0)-c.modalFooterHeight-c.modalHeaderHeight;F<40&&(B-=26),yield P();const b=o(u);if(!b)return;yield P(),i.value=b.scrollHeight,c.fullScreen?e.value=window.innerHeight-c.modalFooterHeight-c.modalHeaderHeight-28:e.value=c.height?c.height:i.value>B?B:i.value,s("height-change",o(e))}catch(m){}}})}return a({scrollTop:H,setModalHeight:f}),(p,g)=>{const m=We("loading");return M(),N(o(Oe),{ref_key:"wrapperRef",ref:t,scrollHeight:i.value},{default:y(()=>[xe((M(),V("div",{ref_key:"spinRef",ref:u,style:Ee(d.value),"loading-tip":n.loadingTip},[$(p.$slots,"default")],12,tt)),[[m,n.loading]])]),_:3},8,["scrollHeight"])}}}),nt=R({name:"ModalClose",__name:"ModalClose",props:{canFullscreen:{type:Boolean,default:!0},fullScreen:{type:Boolean}},emits:["cancel","fullscreen"],setup(n,{emit:a}){const s=n,{prefixCls:c}=ce("basic-modal-close"),{t}=ie(),u=k(()=>[c,`${c}--custom`,{[`${c}--can-full`]:s.canFullscreen}]);function e(i){a("cancel",i)}function r(i){i==null||i.stopPropagation(),i==null||i.preventDefault(),a("fullscreen")}return(i,d)=>(M(),V("div",{class:Le(u.value)},[n.canFullscreen?(M(),V(je,{key:0},[n.fullScreen?(M(),N(o(K),{key:0,title:o(t)("component.modal.restore"),placement:"bottom"},{default:y(()=>[S(o(Ve),{role:"full",onClick:r})]),_:1},8,["title"])):(M(),N(o(K),{key:1,title:o(t)("component.modal.maximize"),placement:"bottom"},{default:y(()=>[S(o(Xe),{role:"close",onClick:r})]),_:1},8,["title"]))],64)):U("",!0),S(o(K),{title:o(t)("component.modal.close"),placement:"bottom"},{default:y(()=>[S(o(Ye),{onClick:e})]),_:1},8,["title"])],2))}}),at=R({name:"BasicModalFooter",__name:"ModalFooter",props:ee,emits:["ok","cancel"],setup(n,{emit:a}){function s(t){a("ok",t)}function c(t){a("cancel",t)}return(t,u)=>{const e=Ie("a-button");return M(),V("div",null,[$(t.$slots,"insertFooter"),t.showCancelBtn?(M(),N(e,L({key:0},t.cancelButtonProps,{onClick:c}),{default:y(()=>[Z(G(t.cancelText),1)]),_:1},16)):U("",!0),$(t.$slots,"centerFooter"),t.showOkBtn?(M(),N(e,L({key:1,type:t.okType,onClick:s,loading:t.confirmLoading},t.okButtonProps),{default:y(()=>[Z(G(t.okText),1)]),_:1},16,["type","loading"])):U("",!0),$(t.$slots,"appendFooter")])}}}),lt=R({name:"BasicModalHeader",__name:"ModalHeader",props:{helpMessage:{type:[String,Array]},title:{type:String}},setup(n){return(a,s)=>(M(),N(o(we),{helpMessage:n.helpMessage},{default:y(()=>[Z(G(n.title),1)]),_:1},8,["helpMessage"]))}});function st(n){const a=h(!1),s=k(()=>{const t=o(n.wrapClassName)||"";return o(a)?`fullscreen-modal ${t} `:o(t)});function c(t){t&&t.stopPropagation(),a.value=!o(a)}return{getWrapClassName:s,handleFullScreen:c,fullScreenRef:a}}const rt=R({name:"BasicModal",inheritAttrs:!1,__name:"BasicModal",props:ee,emits:["open-change","height-change","cancel","ok","register","update:open","fullscreen"],setup(n,{emit:a}){const s=n,c=Ae(),t=h(!1),u=h(null),e=h(null),{prefixCls:r}=ce("basic-modal"),i=h(0),d={setModalProps:_,emitOpen:void 0,redoModalHeight:()=>{P(()=>{o(e)&&o(e).setModalHeight()})}},H=Q();H&&a("register",d,H.uid);const f=k(()=>C(C({},s),o(u))),{handleFullScreen:p,getWrapClassName:g,fullScreenRef:m}=st({modalWrapperRef:e,extHeightRef:i,wrapClassName:qe(f.value,"wrapClassName")}),v=k(()=>{const l=j(C({},o(f)),{open:o(t),okButtonProps:void 0,cancelButtonProps:void 0,title:void 0});return j(C({},l),{wrapClassName:o(g)})}),F=k(()=>{const l=j(C(C({},c),o(f)),{open:o(t)});return l.wrapClassName=`${(l==null?void 0:l.wrapClassName)||""} ${o(g)}vben-basic-modal-wrap`,o(m)?z(l,["height","title"]):z(l,"title")}),B=k(()=>{if(!o(m))return o(v).height});X(()=>{t.value=!!s.open,m.value=!!s.defaultFullscreen}),de(()=>o(t),l=>{a("open-change",l),a("update:open",l),H&&d.emitOpen&&d.emitOpen(l,H.uid),P(()=>{s.scrollTop&&l&&o(e)&&o(e).scrollTop()})},{immediate:!1});function b(l){return A(this,null,function*(){var Y,w;if(l==null||l.stopPropagation(),!((w=(Y=l.target)==null?void 0:Y.classList)!=null&&w.contains(r+"-close--custom"))){if(s.closeFunc&&ge(s.closeFunc)){const E=yield s.closeFunc();t.value=!E;return}t.value=!1,a("cancel",l)}})}function _(l){u.value=Te(o(u)||{},l),Reflect.has(l,"open")&&(t.value=!!l.open),Reflect.has(l,"defaultFullscreen")&&(m.value=!!l.defaultFullscreen)}function W(l){a("ok",l)}function x(l){a("height-change",l)}function I(l){i.value=l}function T(l){s.canFullscreen&&(l.stopPropagation(),O(l))}function O(l){p(l),a("fullscreen")}return(l,Y)=>(M(),N(o(Qe),L(F.value,{onCancel:b}),ne({default:y(()=>[S(ot,L({useWrapper:v.value.useWrapper,footerOffset:l.wrapperFooterOffset,fullScreen:o(m),ref_key:"modalWrapperRef",ref:e,loading:v.value.loading,"loading-tip":v.value.loadingTip,minHeight:v.value.minHeight,height:B.value,open:t.value,modalFooterHeight:l.footer!==void 0&&!l.footer?0:void 0},o(z)(v.value.wrapperProps,"open","height","modalFooterHeight"),{onExtHeight:I,onHeightChange:x}),{default:y(()=>[$(l.$slots,"default")]),_:3},16,["useWrapper","footerOffset","fullScreen","loading","loading-tip","minHeight","height","open","modalFooterHeight"])]),_:2},[l.$slots.closeIcon?void 0:{name:"closeIcon",fn:y(()=>[S(nt,{canFullscreen:v.value.canFullscreen,fullScreen:o(m),onCancel:b,onFullscreen:O},null,8,["canFullscreen","fullScreen"])]),key:"0"},l.$slots.title?void 0:{name:"title",fn:y(()=>[S(lt,{helpMessage:v.value.helpMessage,title:f.value.title,onDblclick:T},null,8,["helpMessage","title"])]),key:"1"},l.$slots.footer?void 0:{name:"footer",fn:y(()=>[S(at,L(F.value,{onOk:W,onCancel:b}),ne({_:2},[ae(Object.keys(l.$slots),w=>({name:w,fn:y(E=>[$(l.$slots,w,le(se(E||{})))])}))]),1040)]),key:"2"},ae(Object.keys(o(z)(l.$slots,"default")),w=>({name:w,fn:y(E=>[$(l.$slots,w,le(se(E||{})))])}))]),1040))}}),D=fe({}),J=fe({});function gt(){const n=h(null),a=h(!1),s=h(0);function c(e,r){if(!Q())throw new Error("useModal() can only be used inside setup() or functional components!");s.value=r,pe(()=>{n.value=null,a.value=!1,D[String(o(s))]=null}),!(o(a)&&Pe()&&e===o(n))&&(n.value=e,a.value=!0,e.emitOpen=(i,d)=>{J[d]=i})}const t=()=>{const e=o(n);return e||ue("useModal instance is undefined!"),e},u={setModalProps:e=>{var r;(r=t())==null||r.setModalProps(e)},getOpen:k(()=>J[~~o(s)]),redoModalHeight:()=>{var e,r;(r=(e=t())==null?void 0:e.redoModalHeight)==null||r.call(e)},openModal:(e=!0,r,i=!0)=>{var f;if((f=t())==null||f.setModalProps({open:e}),!r)return;const d=o(s);if(i){D[d]=null,D[d]=q(r);return}Ke(q(D[d]),q(r))||(D[d]=q(r))},closeModal:()=>{var e;(e=t())==null||e.setModalProps({open:!1})}};return[c,u]}const mt=n=>{const a=h(null),s=Q(),c=h(0),t=()=>{const e=o(a);return e||ue("useModalInner instance is undefined!"),e},u=(e,r)=>{$e(()=>{a.value=null}),c.value=r,a.value=e,s==null||s.emit("register",e,r)};return X(()=>{const e=D[o(c)];e&&(!n||!ge(n)||P(()=>{n(e)}))}),[u,{changeLoading:(e=!0)=>{var r;(r=t())==null||r.setModalProps({loading:e})},getOpen:k(()=>J[~~o(c)]),changeOkLoading:(e=!0)=>{var r;(r=t())==null||r.setModalProps({confirmLoading:e})},closeModal:()=>{var e;(e=t())==null||e.setModalProps({open:!1})},setModalProps:e=>{var r;(r=t())==null||r.setModalProps(e)},redoModalHeight:()=>{var r;const e=(r=t())==null?void 0:r.redoModalHeight;e&&e()}}]},ht=Ne(rt);export{ht as B,mt as a,gt as b,ft as u};
